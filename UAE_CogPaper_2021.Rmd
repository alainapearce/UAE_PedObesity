---
title: "UAE Cognitive Funcintion Paper 2"
output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
header-includes:
- \usepackage{fullpage}
- \usepackage{graphicx}
- \usepackage{subcaption}
- \usepackage{float}
- \usepackage{placeins}
- \usepackage{caption}
- \usepackage{mathtools}
# - \usepackage{multirow}
- \usepackage{amssymb}
- \usepackage{amsmath}
- \usepackage{bigstrut}
- \usepackage{geometry}
# - \usepackage{pdflscape}
- \setlength{\parskip}{1em}
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy = TRUE, tidy.opts = list(comment = FALSE), echo = TRUE, fig.width=6, fig.height=4, fig.path='UAE_CogPaper_Figs/fig-', echo=FALSE, warning=FALSE, message=FALSE, comment = NA)
```

<!-- load startup file and any extra packages -->
```{r load, echo=FALSE, include=FALSE}
library(knitr)
library(kableExtra)
library(lubridate)
library(reshape2)
library(stats)
library(gtsummary)
theme_gtsummary_compact()

library(car)
library(emmeans)
library(ggplot2)
library(ggridges)

source('functions.R')
```

```{r load_scripts, echo=FALSE, results='asis'}
source('1_CogPaper_DataOrg.R')
source('2_CogPaper_tablesWeightStatus.R')
source('3_CogPaper_analyses.R')
source('4_CogPaper_figs.R')
```

\clearpage

# Measurement of Weight Status

We decided to use the International Obesity Task Force (IOTF) designation of weight status for the sample. They use smoothed, sex-specific BMI curves meant to match the the BMI cutoffs for overweight (OW; 25 $kg/m^2$) and obesity (OB; 30 $kg/m^2$) at age 18 yrs.

Rather than BMI-zscore or BMI-percentile, we chose to use percent of overweight cutoff because recent studies shows it has a tighter association with measured adiposity:

BMI $\%$ of overweight = $\frac{child BMI}{BMI\: at\: age-\: and\: sex-\: adjusted\: overweight\: cutoff}*100$

<100 $\%$ - indicates child BMI is below the overweight cutoff for age and sex (i.e., has healthy weight)
100 $\%$ - indicates child BMI is the same as the overweight cutoff for age and sex
>100 $\%$ - indicates child BMI is above the overweight cutoff for age and sex (i.e., has overweight or obesity)

\FloatBarrier

```{r IOTF_pOWcutoff_DensityPlot, echo=FALSE, include = TRUE}
IOTF_pOWcutoff_plot
```

Density plot of percent of overweight by sex. The shaded regions indicated those with healthy weight (blue), overweight (yellow), and obesity (red). The points show denisity of participants by sex (purple circles = female, orange triangles = males).

\FloatBarrier
\clearpage

# Participant Characteristics

```{r Demo_OB_tab, echo=FALSE, results='asis'}
as_kable_extra(UAE_demo_OB, caption = 'Demographic Characteristics by Weight Status', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

\FloatBarrier
\clearpage
  
## Associations between Demographics and Percent of Overweight Cutoff

### t-test for sex
```{r IOTF_pOWcutoff_sex_ttest, echo=FALSE, results='verbatim'}
IOTF_pOWcutoff.sex_ttest
```

### Correlation Matrix

```{r IOTF_pOWcutoff_demo_cors, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_demo_cormat, "latex",  digits = 3, caption = "Correlations between percent of overweight cuttoff and demographic characteristics", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

```{r IOTF_pOWcutoff_demo_cormat_ps, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_demo_cormat_ps, "latex",  digits = 3, caption = "P-vales for the correlations between percent of overweight cuttoff and demographic characteristics", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

Only child age was associated with percent of overweight cutoff - older children tended to have higher percent of overweight cutoff indicating older children were more likely to have overweight or obesity. There was no association with father or mother education level, which differs from finding in the US. Hip to waist ratio was also not associated with percent of overweight cutoff.

\FloatBarrier

### One-Way ANOVA for Income Categories

```{r IOTF_pOWcutoff_income_anova, echo=FALSE, results='verbatim'}
IOTF_pOWcutoff_income_anova
```

\FloatBarrier

There was no difference in percent of overweight by monthly income category. 

\FloatBarrier

### Sensitivity Tests

```{r IOTF_pOWcutoff_age_mod, echo=FALSE, results='asis'}
kable(IOTF_age_pOWcutoff_tab, digits = 3, caption = "Linear Model: pOWcutoff - SES category + Maternal Education + Age + Sex", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

After controlling for family income, mother education, and child sex, child age was significantly associated with percent of overweight such that for each year older, the expected percent of overweight is predicted to increase 4.24%.

\FloatBarrier
\clearpage

# Sleep Behavior

## Correlation Matrix

```{r IOTF_pOWcutoff_cshq_cor, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_CSHQ_cormat, digits = 3, caption = "Correlations between sleep subscales and percent of overweight", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```
\FloatBarrier

```{r IOTF_pOWcutoff_cshq_cor_ps, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_CSHQ_cormat_ps, digits = 3, caption = "Correlations between sleep subscales and percent of overweight", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```
\FloatBarrier

Examining correlations between sleep sub-scales and percent of overweight cutoff reveals greater percent of overweight cutoff was associated with greater parent reported sleep onset delay and sleep disordered breathing.

\FloatBarrier

### Sensitivity Tests

#### Sleep Onset Delay

```{r IOTF_pOWcutoff_sleepdelay, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_sleepdelay_tab, digits = 3, caption = "Linear Model: Sleep Onset Delay - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

After controlling for family income, mother education, child age, and child sex, percent of overweight was positively associated with sleep onset delay such that a child with 110% of overweight, compared to 100% of overweight, would be expected to have a sleep onset delay score that was 0.06 points higher (range of scores = 0 - 3). Additionally, age was positively associated with sleep onset delay such that each year older, the expected sleep disordered breathing score would be 0.12 points higher (range of scores = 0 - 7).

\FloatBarrier

```{r IOTF_pOWcutoff_sleepdelay_adj_plot, echo=FALSE, include = TRUE}
IOTF_pOWcutoff_SleepDelay_adj_plot
```

\FloatBarrier

```{r IOTF_pOWcutoff_sleepdelay_raw_plot, echo=FALSE, include = FALSE}
IOTF_pOWcutoff_SleepDelay_raw_plot
```

\FloatBarrier

#### Sleep Disordered Breathing

```{r IOTF_pOWcutoff_disbreathing, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_breathing_tab, digits = 3, caption = "Linear Model: Sleep Disordered Breathing - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

After controlling for family income, mother education, child age, and child sex, percent of overweight was positively associated with sleep disordered breathing such that a child with 110% of overweight, compared to 100% of overweight, would be expected to have a sleep disordered breathing score that was 0.16 points higher(range of scores = 3 - 9).

\FloatBarrier

```{r IOTF_pOWcutoff_disbreathing_adj_plot, echo=FALSE, include = TRUE}
IOTF_pOWcutoff_DisorderedBreathing_adj_plot
```

\FloatBarrier

```{r IOTF_pOWcutoff_disbreathing_raw_plot, echo=FALSE, include = FALSE}
IOTF_pOWcutoff_DisorderedBreathing_raw_plot
```

\FloatBarrier

\clearpage

# Strengths and Difficulties Questionnaire

```{r SDQ_OB_tab, echo=FALSE, results='asis'}
as_kable_extra(UAE_sdq_OB, caption = 'Strengths and Difficulties by Weight Status', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

There were no differences by weight status.

```{r SDQ_overall_tab, echo=FALSE, results='asis'}
as_kable_extra(UAE_sdq_overall, caption = 'Strengths and Difficulties', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

There were no differences by weight status.

## Exploratory Sex x Percent of Overweight Models

### Emotional Problems

Often complains of headaches

Many worries

Often unhappy, downhearted

Nervous or clingy in new situations

Many fears, easily scared 

\FloatBarrier

```{r IOTF_pOWcutoff_emotprobs_elevated_logit, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_EmotProb_Elevated_tab, digits = 3, caption = "Logistic Model: Emotional Problems (Elevated vs Not) - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

## Conduct Problems

Often has temper tantrums or hot tempers 

Generally obedient - Reverse Scored

Often fights with other children

Often lies or cheats 

Steals from home, school or elsewhere 

\FloatBarrier

```{r IOTF_pOWcutoff_conductprobs_elevated_logit, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_ConductProb_Elevated_tab, digits = 3, caption = "Logistic Model: Conduct Problems (Elevated vs Not) - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Hyperactivity

Restless, overactive

Constantly fidgeting or squirming 

Easily distracted, concentration wanders 

Thinks things out before acting   - Reverse Scored

Sees tasks through to the end - Reverse Scored

\FloatBarrier

```{r IOTF_pOWcutoff_hypeprobs_elevated_logit, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_HypeProb_Elevated_tab, digits = 3, caption = "Logistic Model: Hyperactivity Problems (Elevated vs Not) - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Peer Problems

Rather solitary, tends to play alone 

Has at least one good friend - Reverse Scored

Generally liked by other children - Reverse Scored

Picked on or bullied

Gets on better with adults than with other children

\FloatBarrier

```{r IOTF_pOWcutoff_peerprobs_elevated_logit, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_peerprob_Elevated_tab, digits = 3, caption = "Logistic Model: Peer Problems (Elevated vs Not) - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

When examining odds of experiencing elevated peer problems, controlling for family income, mother education, child age, and child sex, percent of overweight, there was a significant sex x percent of overweight interaction. 

\FloatBarrier

```{r IOTF_pOWcutoff_peerprobs_elevated_emtremds, echo=FALSE, results='verbatim'}
IOTF_pOWcutoff_peerprob_Elevated_emtrends
```

\FloatBarrier

For females, a female child with 110% of overweight cutoff would have 1.27 times the odds of experiencing elevate peer problems than a female child with 100% of overweight cutoff. There was no association between percent of overweight cutoff and odds of peer problems in males.

\FloatBarrier

```{r IOTF_pOWcutoff_peerprob_adjOdds_plot, echo=FALSE, include = FALSE}
IOTF_pOWcutoff_peerprob_ElevatedCat_adjOdds_plot
```

\FloatBarrier

## Prosocial

Considerate of other people's feelings

Shares readily with other children

Helpful if someone is hurt

Kind to younger children

Often volunteers to help others

\FloatBarrier

```{r IOTF_pOWcutoff_prosocialprobs_low_logit, echo=FALSE, results='asis'}
kable(IOTF_pOWcutoff_prosocial_Low_tab, digits = 3, caption = "Logistic Model: Prosocial Problems (Low vs Not) - SES category + Maternal Education + Age + Sex + pOWcutoff", booktabs=TRUE)  %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```


\clearpage
\FloatBarrier
